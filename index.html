<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Code Editor with Layer Move & Sliders</title>
    <style>
        body {
            margin: 0;
            font-family: monospace;
            display: flex;
            flex-direction: column;
            height: 100vh;
            background: #1e1e1e;
        }

        /* Editor layout */
        .editor {
            display: flex;
            background: #1e1e1e;
            color: #ddd;
            overflow: hidden;
            height: 30%;
        }
        .lines {
            background: #2b2b2b;
            padding: 5px;
            text-align: right;
            color: #777;
            user-select: none;
        }
        textarea {
            flex: 1;
            background: transparent;
            border: none;
            color: inherit;
            padding: 5px;
            outline: none;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Buttons */
        button {
            padding: 8px 14px;
            margin: 5px;
            cursor: pointer;
            border: none;
            color: white;
            font-size: 14px;
            border-radius: 4px;
            transition: transform 0.2s ease, background 0.2s ease;
        }
        .run-btn {
            background: #4caf50;
        }
        .run-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }
        .clear-btn {
            background: #f44336;
        }
        .clear-btn:hover {
            background: #da3c30;
            transform: scale(1.05);
        }
        #layerBtn, #moveBtn {
            background: #2196F3;
        }
        #layerBtn:hover, #moveBtn:hover {
            background: #1e88e5;
            transform: scale(1.05);
        }

        /* Preview iframe */
        iframe {
            width: 100%;
            height: 40%;
            border: 1px solid #000;
            margin-top: 10px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }

        /* Layer panel */
        #layerPanel {
            background: #222;
            color: #ddd;
            padding: 10px;
            display: none;
            flex-direction: column;
            gap: 10px;
            position: relative;
            border-radius: 8px;
        }
        .layerItem {
            border: 1px solid #555;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            border-radius: 4px;
        }
        .layerItem.selected {
            outline: 2px solid #ffd700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }

        /* Controls section under layers */
        #layerControlsPanel {
            display: none;
            flex-direction: column;
            gap: 10px;
            padding: 10px;
            background: #333;
            border-radius: 8px;
        }

        /* Slider panel under preview */
        #sliderPanel {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 10px;
            background: #222;
            border-radius: 8px;
            margin-top: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .slider-container label {
            color: #ddd;
            font-size: 14px;
            width: 50px;
        }

        /* Bigger sliders */
        input[type=range] {
            width: 100%;
            height: 30px;
            -webkit-appearance: none;
            background: #555;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        input[type=range]:hover {
            background: #666;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 40px;
            width: 40px;
            background: #e74c3c;
            border-radius: 50%;
            cursor: pointer;
            margin-top: -6px;
            box-shadow: 0 0 8px rgba(231, 76, 60, 0.7);
        }
        input[type=range]::-moz-range-thumb {
            height: 40px;
            width: 40px;
            background: #e74c3c;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(231, 76, 60, 0.7);
        }

        /* Highlight for selected element in preview */
        .highlight {
            outline: 2px solid #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
        }

        /* Version number at bottom */
        .bottom-number {
            margin-top: auto;
            text-align: center;
            padding: 10px;
            background: #222;
            color: #fff;
            font-size: 24px;
            border-top: 1px solid #444;
        }
    </style>
</head>
<body>

<!-- Buttons -->
<button class="run-btn" onclick="runCode()">Run</button>
<button class="clear-btn" onclick="clearCode()">Clear</button>
<button id="layerBtn">Layer Selection</button>

<!-- Editor -->
<div class="editor">
    <div class="lines" id="lineNumbers">1</div>
    <textarea id="code" oninput="updateLines()" spellcheck="false">// Type HTML, SVG, CSS, JS here
<div style="width:100px;height:100px;background:orange;margin:20px;">Box</div>
<p style="color:blue;font-size:20px;">Hello World</p>
<svg width="100" height="100"><circle cx="50" cy="50" r="40" fill="green"/></svg>
<img src="https://via.placeholder.com/50" />
    </textarea>
</div>

<!-- Preview -->
<iframe id="preview"></iframe>

<!-- Slider panel -->
<div id="sliderPanel">
    <div class="slider-container">
        <label>Slider 1</label>
        <input type="range" id="slider1" min="0" max="100" value="">
    </div>
    <div class="slider-container">
        <label>Slider 2</label>
        <input type="range" id="slider2" min="0" max="100" value="">
    </div>
    <div class="slider-container">
        <label>Slider 3</label>
        <input type="range" id="slider3" min="0" max="100" value="">
    </div>
    <div class="slider-container">
        <label>Slider 4</label>
        <input type="range" id="slider4" min="0" max="100" value="">
    </div>
</div>

<!-- Layer panel -->
<div id="layerPanel"></div>

<!-- Move controls -->
<div id="layerControlsPanel">
    <button id="moveBtn">Move</button>
    <div id="moveSliders" style="display:none;">
        <label>X: <input type="range" id="sliderX" min="0" max="300" value="0"></label>
        <label>Y: <input type="range" id="sliderY" min="0" max="300" value="0"></label>
    </div>
</div>

<!-- Version number -->
<div class="bottom-number">5</div>

<script>
const codeArea = document.getElementById("code");
const lineNumbers = document.getElementById("lineNumbers");
const preview = document.getElementById("preview");
const layerBtn = document.getElementById('layerBtn');
const layerPanel = document.getElementById('layerPanel');
const layerControlsPanel = document.getElementById('layerControlsPanel');
const moveBtn = document.getElementById('moveBtn');
const moveSliders = document.getElementById('moveSliders');
const sliderX = document.getElementById('sliderX');
const sliderY = document.getElementById('sliderY');

let layerMode = false;
let selectedLayer = null;
let selectedPreviewEl = null;

// Update line numbers
function updateLines() {
    const code = codeArea.value;
    const lineCount = code.split("\n").length;
    lineNumbers.innerText = Array.from({length: lineCount}, (_, i) => i + 1).join("\n");
}
updateLines();

// Run code: display in iframe
function runCode() {
    preview.srcdoc = codeArea.value;
    layerPanel.style.display = 'none';
    layerControlsPanel.style.display = 'flex';
    moveSliders.style.display = 'none';
    selectedLayer = null;
    selectedPreviewEl = null;
}

// Clear editor and preview
function clearCode() {
    codeArea.value = '';
    updateLines();
    preview.srcdoc = '';
    layerPanel.style.display = 'none';
    moveSliders.style.display = 'none';
    selectedLayer = null;
    selectedPreviewEl = null;
}

// Toggle layer selection
layerBtn.addEventListener('click', () => {
    layerMode = !layerMode;
    layerPanel.style.display = layerMode ? 'flex' : 'none';
    layerBtn.textContent = layerMode ? 'Exit Layer Selection' : 'Layer Selection';
    
    if (!layerMode) {
        const doc = preview.contentDocument || preview.contentWindow.document;
        doc.querySelectorAll('*').forEach(el => el.classList.remove('highlight'));
    }
});

// Layer selection inside iframe
preview.addEventListener('load', () => {
    const doc = preview.contentDocument || preview.contentWindow.document;
    
    doc.body.addEventListener('click', e => {
        if (!layerMode) return;
        e.preventDefault();
        e.stopPropagation();
        
        const target = e.target;
        if (target === doc.body) return;

        doc.querySelectorAll('*').forEach(el => el.classList.remove('highlight'));
        target.classList.add('highlight');

        // Clear previous layer items
        layerPanel.innerHTML = '';

        // Add layer item
        const layerItem = document.createElement('div');
        layerItem.className = 'layerItem';
        
        const wrapper = document.createElement('div');
        wrapper.style.transform = 'scale(0.6)';
        wrapper.style.transformOrigin = 'top left';
        wrapper.style.width = target.offsetWidth + 'px';
        wrapper.style.height = target.offsetHeight + 'px';
        wrapper.innerHTML = target.outerHTML;
        
        layerItem.appendChild(wrapper);

        // Click to select layer
        layerItem.addEventListener('click', () => {
            if (selectedLayer) selectedLayer.classList.remove('selected');
            selectedLayer = layerItem;
            selectedLayer.classList.add('selected');
            selectedPreviewEl = target;
            moveSliders.style.display = 'none';
            sliderX.value = parseInt(target.style.left || 0);
            sliderY.value = parseInt(target.style.top || 0);
            target.style.position = 'absolute';
        });

        layerPanel.appendChild(layerItem);
    }, true);
});

// Move button
moveBtn.addEventListener('click', () => {
    if (!selectedPreviewEl) return;
    moveSliders.style.display = moveSliders.style.display === 'none' ? 'block' : 'none';
});

// Sliders control selected preview element
sliderX.addEventListener('input', () => {
    if (!selectedPreviewEl) return;
    selectedPreviewEl.style.left = sliderX.value + 'px';
    selectedPreviewEl.style.position = 'absolute';
});
sliderY.addEventListener('input', () => {
    if (!selectedPreviewEl) return;
    selectedPreviewEl.style.top = sliderY.value + 'px';
    selectedPreviewEl.style.position = 'absolute';
});
</script>
</body>
</html>
