<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shapes with Shared Light</title>
<style>
  body {
    margin: 0;
    font-family: monospace;
    background: #000;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }
  .controls { margin-bottom: 10px; display: flex; gap: 5px; flex-wrap: wrap; }
  button { padding: 8px 14px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
  .shape1-btn { background: #4caf50; color: #fff; }
  .shape2-btn { background: #f44336; color: #fff; }
  .light-btn { background: #ffeb3b; color: #000; }
  .move-btn { background: #2196F3; color: #fff; }
  .arrow-btn { width: 40px; height: 40px; font-size: 20px; background: #333; color: #fff; }
  #preview { width: 400px; height: 400px; background: #000; position: relative; border: 1px solid #555; overflow: hidden; }
  .shape { width: 150px; height: 150px; background: green; position: absolute; top: 125px; left: 125px; overflow: hidden; }
  .shape2 { width: 100px; height: 100px; background: red; border-radius: 50%; position: absolute; top: 50px; left: 50px; overflow: hidden; }
  .light { width: 200px; height: 200px; border-radius: 50%; position: absolute;
    background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0.6) 40%, rgba(255,255,0,0.2) 70%, rgba(255,255,0,0) 100%);
    filter: blur(15px);
    pointer-events: none; /* allow clicks to pass through */
  }
  .arrows { display: none; gap: 5px; margin-top: 5px; }
</style>
</head>
<body>

<div class="controls">
  <button class="shape1-btn">Add Green Square</button>
  <button class="shape2-btn">Add Red Circle</button>
  <button class="light-btn">Add Light</button>
  <button class="move-btn">Move Light</button>
  <button class="save-btn">Save Light</button>
</div>

<div class="arrows">
  <button class="arrow-btn" data-dx="0" data-dy="-10">↑</button>
  <button class="arrow-btn" data-dx="0" data-dy="10">↓</button>
  <button class="arrow-btn" data-dx="-10" data-dy="0">←</button>
  <button class="arrow-btn" data-dx="10" data-dy="0">→</button>
</div>

<div id="preview"></div>

<script>
const preview = document.getElementById('preview');
const greenBtn = document.querySelector('.shape1-btn');
const redBtn = document.querySelector('.shape2-btn');
const lightBtn = document.querySelector('.light-btn');
const moveBtn = document.querySelector('.move-btn');
const arrows = document.querySelector('.arrows');
const saveBtn = document.querySelector('.save-btn');

let layers = [];
let lightDiv = null;

// Add shapes
greenBtn.addEventListener('click', () => {
  const shapeDiv = document.createElement('div');
  shapeDiv.className = 'shape';
  preview.appendChild(shapeDiv);
  layers.push(shapeDiv);
});

redBtn.addEventListener('click', () => {
  const shapeDiv = document.createElement('div');
  shapeDiv.className = 'shape2';
  preview.appendChild(shapeDiv);
  layers.push(shapeDiv);
});

// Add shared light (on top of preview, but visually inside shapes)
lightBtn.addEventListener('click', () => {
  if(lightDiv) return;
  lightDiv = document.createElement('div');
  lightDiv.className = 'light';
  lightDiv.style.top = '100px';
  lightDiv.style.left = '100px';
  preview.appendChild(lightDiv);
});

// Toggle move arrows
moveBtn.addEventListener('click', () => {
  arrows.style.display = arrows.style.display === 'flex' ? 'none' : 'flex';
});

// Move light with arrows
arrows.querySelectorAll('.arrow-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    if(!lightDiv) return;
    const dx = parseInt(btn.dataset.dx);
    const dy = parseInt(btn.dataset.dy);
    let top = parseInt(lightDiv.style.top || 0);
    let left = parseInt(lightDiv.style.left || 0);
    lightDiv.style.top = (top + dy) + 'px';
    lightDiv.style.left = (left + dx) + 'px';
  });
});

// Save light into each shape
saveBtn.addEventListener('click', () => {
  if(!lightDiv) return;
  layers.forEach(shape => {
    const savedLight = document.createElement('div');
    savedLight.className = 'light';
    // compute light relative to shape
    const rect = shape.getBoundingClientRect();
    const previewRect = preview.getBoundingClientRect();
    const offsetTop = parseInt(lightDiv.style.top) - (rect.top - previewRect.top);
    const offsetLeft = parseInt(lightDiv.style.left) - (rect.left - previewRect.left);
    savedLight.style.top = offsetTop + 'px';
    savedLight.style.left = offsetLeft + 'px';
    shape.appendChild(savedLight);
  });
  // remove interactive light
  lightDiv.remove();
  lightDiv = null;
});
</script>

</body>
</html>
